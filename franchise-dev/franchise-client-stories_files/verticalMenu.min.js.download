"use strict";define("verticalMenu/components/verticalMenuDomBuilder",["react","lodash","zepto","utils"],function(e,t,i,s){function n(e,t){var i;if(e.link&&"PageLink"===e.link.type&&e.link.pageId.id===t)return!0;for(i=0;i<e.items.length;i++)if(n(e.items[i],t))return!0;return!1}function a(e){var t=i(e.target).find("a")[0];return!t||(t.click(),!1)}function r(e,i,n,a,r,o,u,l,p){var c={};c[i+"_selected"]=n,c[i+"_hover"]=s.stringUtils.startsWith(o,r),c[e]=!0;var m={className:s.classNames(c),style:{height:a},onClick:l?u.click:u.leave,id:r,key:r};return p&&t.assign(m,{onMouseEnter:u.enter,onMouseLeave:u.leave,onFocus:u.focus,onBlur:u.blur,onKeyDown:u.keyDown}),m}function o(e,t,i,s){return{style:{marginBottom:s+"px"},className:e?t:t+" "+i+"_emptySubMenu"}}function u(e,i,s,n,a,r,o){var u={className:e+" "+i+"_label level"+a,style:{lineHeight:s+"px"},role:"button","aria-haspopup":o,onClick:o?r.click:r.leave};return n&&t.merge(u,n.render),u}function l(e){t.includes(e.className,"Wrapper")&&(e.onClick=a)}return{getSkin:function(e,t){return e[t]},buildTemplate:function(e,i){var s=e.slice(3,e.length),n=[];return t.forEach(s,function(e){t.isArray(e)&&n.push(this.buildTemplate(e,i))}.bind(this)),{tag:e[0].toLowerCase(),skinPart:e[1],className:t.map(e[2],function(e){return i+e}),items:n}},buildDomItem:function(i,s,a,p,c,m,h,b,d,f,g,v){var M=e.DOM[s.tag],y=[],I={className:s.className.concat(p.link?"":c+"_noLink").join(" ")},D=d+a.indexOf(p)+"_",k=t.filter(p.items,{isVisible:!0}).length>0;switch(s.tag){case"a":y.push(p.label),I=u(I.className,c,h.line,p.link,b,g,k);break;case"ul":t.forEach(p.items,function(e){e.isVisible&&y.push(this.buildDomItem(i,i,p.items,e,c,m,h,b+1,D,f,g,v))}.bind(this)),I=o(k,I.className,c,h.separator);break;case"li":t.forEach(s.items,function(e){y.push(this.buildDomItem(i,e,a,p,c,m,h,b,d,f,g,v))}.bind(this)),I=r(I.className,c,n(p,m),h.item,D,f,g,k,v);break;default:t.forEach(s.items,function(e){y.push(this.buildDomItem(i,e,a,p,c,m,h,b,d,f,g,v))}.bind(this))}return l(I),"ul"===s.tag?M(I,y):M.apply(null,[I].concat(y))},buildDOMFromTemplate:function(i,s,n,a,r,o,u,l){var p=i.items[0],c=t(s).filter("isVisible").map(function(e){return this.buildDomItem(p,p,s,e,n,a,r,0,"root",o,u,l)}.bind(this)).value();return e.DOM.ul({className:n+"menuContainer"},c)}}}),define("verticalMenu/components/verticalMenuItem",["skins","verticalMenu/components/verticalMenuDomBuilder"],function(e,t){return{displayName:"MenuItem",render:function(){var i=t.getSkin(e.skins,this.props.skin),s=t.buildTemplate(i.react[0],this.props.classPrefix);return t.buildDOMFromTemplate(s,this.props.data,this.props.classPrefix,this.props.currentUrlPageId,this.props.heights,this.props.hoverId,this.props.callbacks,this.props.isDesktop,this.props.isIE)}}}),define("verticalMenu",["zepto","lodash","react","core","utils","verticalMenu/components/verticalMenuItem","reactDOM","santaProps"],function(e,t,i,s,n,a,r,o){function u(t){var i=c(t.target),s=i.id,n=e(i).find("ul")[0].children.length>0,a=s===this.state.hoverId;n?a?this.setState({hoverId:null}):(this.setState({hoverId:s}),t.preventDefault()):this.setState({hoverId:null})}function l(e){var t=c(e.target).id;t!==this.state.hoverId&&this.setState({hoverId:t})}function p(){this.setState({hoverId:null})}function c(e){for(;"LI"!==e.tagName;)e=e.parentElement;return e}var m=s.compMixins,h=i.createFactory(i.createClass(a)),b={displayName:"VerticalMenu",mixins:[m.skinBasedComp,m.skinInfo],propTypes:{browser:o.Types.Browser.browser.isRequired,isMobileDevice:o.Types.Device.isMobileDevice,isTabletDevice:o.Types.Device.isTabletDevice,siteMenuWithRender:o.Types.Menu.siteMenuWithRender,currentUrlPageId:o.Types.Component.currentUrlPageId.isRequired,compData:o.Types.Component.compData,compProp:o.Types.Component.compProp,styleId:o.Types.Component.styleId,skin:o.Types.Component.skin,style:o.Types.Component.style},statics:{useSantaTypes:!0},subMenuTabbableItems:!1,getInitialState:function(){return{$subMenuOpenSide:"subMenuOpenSide-"+this.props.compProp.subMenuOpenSide,$itemsAlignment:"items-align-"+this.props.compProp.itemsAlignment,$subItemsAlignment:"subItems-align-"+this.props.compProp.itemsAlignment,hoverId:null}},componentWillReceiveProps:function(e){e.compProp.itemsAlignment!==this.props.compProp.itemsAlignment&&this.setState({$itemsAlignment:"items-align-"+e.compProp.itemsAlignment,$subItemsAlignment:"subItems-align-"+e.compProp.itemsAlignment}),e.compProp.subMenuOpenSide!==this.props.compProp.subMenuOpenSide&&this.setState({$subMenuOpenSide:"subMenuOpenSide-"+e.compProp.subMenuOpenSide})},updateDOMDataAttributes:function(){var e=r.findDOMNode(this),t=this.getParamValues();this.lastParams=t,e.setAttribute("data-param-border",t.border),e.setAttribute("data-param-separator",t.separator),e.setAttribute("data-param-padding",t.padding)},componentDidMount:function(){this.updateDOMDataAttributes()},componentDidUpdate:function(){t.isEqual(this.getParamValues(),this.lastParams)||this.updateDOMDataAttributes()},getParamValues:function(){var e=this.getParamFromDefaultSkin("separatorHeight")||this.getParamFromDefaultSkin("sepw"),t=this.getParamFromDefaultSkin("textSpacing"),i=this.getParamFromDefaultSkin("brw");return{separator:e?parseInt(e.value,10):0,border:i?parseInt(i.value,10):0,padding:t?parseInt(t.value,10):0}},handleKeyDownForMainMenu:function(i){var s,a,o=n.accessibility.getTabbaleElements(r.findDOMNode(this)),u=c(i.target),l=t.head(e(u).find("ul"));if(l){var p=n.accessibility.getTabbaleElements(l);o=t.difference(o,p)}if("ArrowDown"===i.key||!i.shiftKey&&"Tab"===i.key){if(i.stopPropagation(),i.preventDefault(),(s=t.indexOf(o,i.target)+1)===o.length)return a=n.accessibility.getTabbaleElements(window.document),(s=t.indexOf(a,i.target)+1)===a.length&&(s=0),void a[s].focus();o[s].focus()}if("ArrowUp"===i.key||i.shiftKey&&"Tab"===i.key){if(i.stopPropagation(),i.preventDefault(),(s=t.indexOf(o,i.target)-1)<0)return a=n.accessibility.getTabbaleElements(window.document),(s=t.indexOf(a,i.target)-1)<0&&(s=a.length-1),void a[s].focus();o[s].focus()}},handleKeyDownForSubMenu:function(e){var i;("ArrowDown"===e.key||!e.shiftKey&&"Tab"===e.key)&&(e.stopPropagation(),e.preventDefault(),(i=t.indexOf(this.subMenuTabbableItems,e.target)+1)===this.subMenuTabbableItems.length&&(i=0),this.subMenuTabbableItems[i].focus()),("ArrowUp"===e.key||e.shiftKey&&"Tab"===e.key)&&(e.stopPropagation(),e.preventDefault(),(i=t.indexOf(this.subMenuTabbableItems,e.target)-1)<0&&(i=this.subMenuTabbableItems.length-1),this.subMenuTabbableItems[i].focus()),"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),this.lastFocusedMainMenuItem.focus(),this.subMenuTabbableItems=null,p.call(this))},menuItemKeyDownHandler:function(i){if(("ArrowRight"===i.key&&"right"===this.props.compProp.subMenuOpenSide||"ArrowLeft"===i.key&&"left"===this.props.compProp.subMenuOpenSide)&&!this.subMenuTabbableItems){i.stopPropagation(),i.preventDefault();var s=c(i.target),a=t.head(e(s).find("ul"));if(a){var r=n.accessibility.getTabbaleElements(a);t.head(r).focus(),this.subMenuTabbableItems=r,this.lastFocusedMainMenuItem=i.target}}else this.subMenuTabbableItems?this.handleKeyDownForSubMenu(i):this.handleKeyDownForMainMenu(i)},getSkinProperties:function(){var e=this.getParamValues(),t=this.getSkinExports(),i=this.props.siteMenuWithRender,s=n.verticalMenuCalculations.getVisibleItemsCount(i),a=n.verticalMenuCalculations.getItemHeight(this.props.style.height,e.separator,s,t);return{"":{tagName:"nav"},menuContainer:{parentConst:h,data:i,skin:this.props.skin,classPrefix:this.props.styleId,currentUrlPageId:this.props.currentUrlPageId,heights:{separator:t&&t.separatorNotIncludedInLineHeight?0:e.separator,line:n.verticalMenuCalculations.getLineHeight(a,e.separator,e.border,t),item:a},callbacks:{click:u.bind(this),enter:l.bind(this),leave:p.bind(this),focus:l.bind(this),blur:p.bind(this),keyDown:this.menuItemKeyDownHandler},hoverId:this.state.hoverId,isDesktop:!(this.props.isMobileDevice||this.props.isTabletDevice),isIE:!!this.props.browser.ie}}}};return s.compRegistrar.register("wysiwyg.common.components.verticalmenu.viewer.VerticalMenu",b,!0),b});
//# sourceMappingURL=verticalMenu.min.js.map