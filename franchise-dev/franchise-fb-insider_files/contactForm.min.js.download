"use strict";define("contactForm",["lodash","santaProps","utils","formCommon","react","core"],function(e,t,i,r,n,s){function a(){var e=this.state.notifications;return{notifications:{"aria-live":"polite",className:this.classSet({error:e.error,success:!e.error}),children:[e.message]}}}function l(e,t){return"userLang"===e?t:e}function o(t,r,n){var s=i.validationUtils;return!(!t.hidden&&t.required)||(r===g.call(this)?s.isValidEmail(n):!e.isEmpty(n))}function c(e,t,i,r){return r?d(e,t,i):p.call(this,t,e[t])}function u(t){return e.reduce(e.keys(t),function(e,t){return"notification"===t?e:e&&t},!0)}function d(t,i,r){var n={},s=t[i];return s&&s.error&&(n[i]={error:!0},u(t)&&(n.notifications={error:!1,message:""})),n[i]=e.assign(n[i]||{},{hidden:s.hidden,required:s.required,value:r}),n}function p(e,t){var i={};return i[e]={error:!0,hidden:t.hidden,required:t.required,value:t.value},i.notifications={message:e===g.call(this)?this.props.errorMessage:this.props.validationErrorMessage,error:!0},i}function f(t){var i=t.target.id.replace(this.props.id,"");this.setState(e.assign(this.state[i],{error:!1}))}function h(t){var i=t.target.id.replace(this.props.id,"");this.setState(e.assign(this.state[i],{value:t.target.value,error:!1}))}function m(t){null!==t&&e.set(this,["refsToInputComps",t.id],t)}function v(t){var i=e.find(t,{fieldType:"message"})?t:t.concat({fieldType:"message",hidden:!1});return e.reduce(i,function(e,t){var i=!t.hidden,r=b(t);return e["$"+r]=i?r+"Hidden":"",e},{})}function g(){return b(e.find(this.props.orderedFields,{fieldType:"email"}))}function y(){return this.state[g.call(this)]}function F(){var t=e.find(this.props.orderedFields,{fieldType:"name"});return t?this.state[b(t)]:null}function b(e){return"message"===e.fieldType?"fieldMessage":"field"+(e.index+1)}function C(e){return"message"===e.fieldType?"label_fieldMessage":"label_field"+(e.index+1)}function T(e){return"message"===e.fieldType?"fieldMessageContainer":"field"+(e.index+1)+"Container"}function k(e,t){return t&&e.fieldLabel?e.fieldLabel+(e.required?" *":""):e.fieldLabel}function S(t,i){var r=this.state[t]||{},n={required:!!i.required,hidden:!i.hidden,hiddenField:!i.hidden};return e.merge(r,n),{skinId:t,fieldType:i.fieldType,name:i.fieldLabel,value:r.value,required:i.required,className:this.classSet(r),placeholder:k(i,this.props.isDynamicContactForm),onChange:h.bind(this),onClick:f.bind(this),"data-aid":i.fieldType+"Field"}}function w(){return this.props.orderedFields.reduce(function(e,t){var i=b(t),r=S.call(this,i,t);return e.push(r)&&e}.bind(this),[])}function E(){return this.props.orderedFields.reduce(function(e,t){var i=!t.hidden,r={skinId:C(t),className:this.classSet({hidden:i,hiddenField:i}),children:[k(t,this.props.isDynamicContactForm)],"data-aid":"label_"+t.fieldType};return e.push(r)&&e}.bind(this),[])}function q(){return"contactform.FieldAnimationSkin"!==this.props.skin?[]:this.props.orderedFields.reduce(function(e,t){var i={skinId:T(t),className:this.classSet({hiddenField:!t.hidden})};return e.push(i)&&e}.bind(this),[])}function N(t,i){return e.mergeWith(t,i,function(e,t,i){if("className"===i)return((e||"")+" "+(t||"")).trim()})}function L(e){return e.required?"true":null}function x(e){return this.state[e]&&this.state[e].error?"true":"false"}function I(e){return"phone"===e.fieldType?"tel":"text"}function M(e,t,i,r){var s=b({index:e}),a=n.createElement("span",N({id:C({index:e}),className:this.classSet({label:!0})},i)),l=n.createElement("div",{id:"field"+(e+1)+"-cover",className:this.classSet({"input-cover":!0})},[a]),o=n.createElement("input",N({id:s,ref:m.bind(this),type:I(t),className:this.classSet({input:!0}),required:L(t),"aria-invalid":x.call(this,s)},t));return n.createElement("label",N({id:T({index:e}),className:this.classSet({"input-container":!0})},r),[o,l])}function A(t,i,r){var s=b({index:t}),a=n.createElement("label",e.merge({id:C({index:t}),htmlFor:s},r),r.children[0]),l=n.createElement("input",e.merge({id:s,ref:m.bind(this),type:I(i),required:L(i),"aria-invalid":x.call(this,s)},i));return n.createElement("div",null,[a,l])}function D(t,i,r){var s=this.classSet({col:!0}),a=b({index:t}),l=n.createElement("label",e.merge({id:C({index:t}),htmlFor:a,className:s},r),r.children[0]),o=n.createElement("input",e.merge({id:a,ref:m.bind(this),type:I(i),required:L(i),"aria-invalid":x.call(this,a)},i)),c=n.createElement("div",{className:s},o);return n.createElement("li",{className:this.classSet({row:!0})},[l,c])}function R(e,t){var i=b({index:e});return n.createElement("input",N({id:i,ref:m.bind(this),key:i,type:I(t),required:L(t),"aria-invalid":x.call(this,i)},t))}function V(e,t){var i={};i.fieldInput=!0;var r=b({index:e});return n.createElement("input",N({id:r,ref:r,key:r,type:I(t),className:this.classSet(i),required:L(t),"aria-invalid":x.call(this,r)},t))}function B(t){var i=this,r={"field1-hook":M.call(i,0,t[0].input,t[0].label,t[0].container)};return t[1]?(e.assign(r,{"field2-hook":M.call(i,1,t[1].input,t[1].label,t[1].container)}),e.assign(r,{"fieldN-hook":n.createElement("div",null,e.map(t.slice(2),function(e,r){var n=r+2;return M.call(i,n,t[n].input,t[n].label,t[n].container)}))})):r}function O(t){var i=this,r={"field1-hook":R.call(i,0,t[0].input)};return t[1]?(e.assign(r,{"field2-hook":R.call(i,1,t[1].input)}),e.assign(r,{"fieldN-hook":n.createElement("div",null,e.map(t.slice(2),function(e,r){var n=r+2;return R.call(i,n,t[n].input)}))})):r}function P(t){var i=this;return{"fieldN-hook":n.createElement("div",null,e.map(t,function(e,r){return R.call(i,r,t[r].input)}))}}function W(t){var i=this;return{"fieldN-hook":n.createElement("div",null,e.map(t,function(e,r){return A.call(i,r,t[r].input,t[r].label)}))}}function _(t){var i=this;return{wrapper:{addChildrenBefore:e.map(t,function(e,r){return V.call(i,r,t[r].input)})}}}function z(t){var i=this;return{wrapper:{addChildrenBefore:e.map(t,function(e,r){return D.call(i,r,t[r].input,t[r].label)})}}}function H(e){switch(this.props.skin){case"contactform.FieldAnimationSkin":return B.call(this,e);case"contactform.FullWidthButtonSkin":case"contactform.LineOnlySkin":return O.call(this,e);case"contactform.OverlappingButtonSkin":case"wysiwyg.viewer.skins.contactform.BasicContactFormSkin":case"wysiwyg.viewer.skins.contactform.DefaultContactForm":return P.call(this,e);case"wysiwyg.viewer.skins.contactform.VerticalForm":return W.call(this,e);case"wysiwyg.viewer.skins.contactform.VerticalFormLabelsLeft":return z.call(this,e);case"wysiwyg.viewer.skins.contactform.HorizontalContactFormSkin":return _.call(this,e);default:return{}}}function K(t){return"fieldMessage"===e.last(t).input.skinId}function j(e){return e.splice(-1)[0]}function U(){return e.zipWith(w.call(this),E.call(this),q.call(this),function(e,t,i){return{input:e,label:t,container:i}})}function $(t){var i={className:this.classSet({hiddenField:!0})},r={};if("wysiwyg.viewer.skins.contactform.HorizontalContactFormSkin"===this.props.skin){var n={};n.message=!0,r.className=this.classSet(n)}return{fieldMessage:N(e.get(t,"input",i),r),label_fieldMessage:e.get(t,"label",i),fieldMessageContainer:e.get(t,"container",i)}}function G(){return e.reduce(this.props.orderedFields,function(e,t){return t.hidden&&e.push({name:t.fieldType,label:t.fieldLabel,value:this.state[b(t)].value||""}),e}.bind(this),[])}function J(){return e.reduce(this.props.orderedFields,function(e,t){return t.hidden&&(e[t.fieldType]=this.state[b(t)].value||""),e}.bind(this),{})}function Q(e){return this.refsToInputComps[e]?this.refsToInputComps[e].value:this.refs[e]?this.refs[e].value:""}var X=["da","de","en","es","fr","hi","it","ja","ko","nl","no","pl","pt","ru","sv","tr"],Y={displayName:"ContactForm",mixins:[r.formMixin],propTypes:{orderedFields:t.Types.ContactFormSantaTypes.orderedFields.isRequired,errorMessage:t.Types.ContactFormSantaTypes.errorMessage.isRequired,validationErrorMessage:t.Types.ContactFormSantaTypes.validationErrorMessage.isRequired,isDynamicContactForm:t.Types.ContactFormSantaTypes.isDynamicContactForm.isRequired,isExperimentOpen:t.Types.isExperimentOpen,skin:t.Types.Component.skin.isRequired,styleId:t.Types.Component.styleId},statics:{useSantaTypes:!0},componentWillReceiveProps:function(t){var i=v(this.props.orderedFields),r=v(t.orderedFields);e.isEqual(i,r)||this.setState(r)},getFormInitialState:function(){var t={mailSent:!1,notifications:{error:!1,message:"",hidden:!0,required:!1}},i=this.props.orderedFields.reduce(function(e,t){return e[b(t)]={error:!1,hidden:!t.hidden,required:!!t.required},e},t),r=v(this.props.orderedFields);return e.merge(i,r)},getCleanFormState:function(){return e.reduce(this.props.orderedFields,function(e,t){var i=b(t);return e[i]=e[i]||{},e[i].value="",e},{})},getLanguage:function(){var t=l(this.props.compProp.dataLang,this.props.userLanguage);return e.includes(X,t)?t:"en"},getFormAriaLabel:function(){var t=this.getLanguage();return e.get(i.translations.componentTranslations,[t,this.getFormAriaLabelName()],this.getFormAriaLabelName())},getFormAriaLabelName:function(){return"contact form"},getActivityName:function(){return this.props.isDynamicContactForm?"DynamicContactFormActivity":"ContactFormActivity"},getFormFields:function(){var t=this,i=e.reduce(t.props.orderedFields,function(e,i){if(i.hidden){var r=i.fieldLabel,n=t.state[b(i)].value||"";e.displayed[r]=n,e.structured.push({type:i.fieldType,label:r,value:n})}return e},{displayed:{},structured:[]});return i.getAll=function(t){return e.filter(i.structured,{type:t})},{newModel:!0,data:i}},getFieldsForActivityReporting:function(){return this.props.isDynamicContactForm?G.call(this):J.call(this)},getFieldLabels:function(){return e(this.props.orderedFields).filter(function(t){return e.has(t,"fieldType")}).map(function(e){return{type:e.fieldType,label:e.fieldLabel}}).value()},getFieldValue:function(e){return this.refsToInputComps[e]?this.refsToInputComps[e].value:this.refs[e]?this.refs[e].value:""},isFormValid:function(){var t=this.state,i=e.clone(t),r=y.call(this),n=r.value,s=g.call(this),a=o.call(this,r,s,n);i=c.call(this,t,s,n,a);var l;a&&(l=e.reduce(this.props.orderedFields,function(r,n){var s=b(n),a=Q.call(this,s),l=o.call(this,t[s],s.toLowerCase(),a);return i=e.assign(i,c.call(this,t,s,a,l)),r&&l}.bind(this),!0));var u=e.findKey(i,"error");return u&&this.refsToInputComps[u]?this.refsToInputComps[u].focus():this.refs[u]&&this.refs[u].focus(),this.setState(i),l},getInputName:function(){var e=F.call(this),t=e?e.value:null;return this.props.isExperimentOpen("sendContactFormEmailsViaPong")?t||null:t||"n/a"},getLangKeys:function(e){return i.translations.contactFormTranslations[e]},getFormSkinProperties:function(){var t=U.call(this),i=K(t)?j(t):{},r=$.call(this,i),n=H.call(this,t),s=a.call(this);return e.assign(r,n,s,{privateMembers:t,"form-wrapper":{"aria-label":this.getFormAriaLabel("contact form")}})}};return s.compRegistrar.register("wysiwyg.viewer.components.ContactForm",Y,!0).register("wysiwyg.viewer.components.DynamicContactForm",Y,!0),Y});
//# sourceMappingURL=contactForm.min.js.map